(this["webpackJsonpaudit-report-ui"]=this["webpackJsonpaudit-report-ui"]||[]).push([[0],{10:function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),a=n(4),s=n.n(a);async function i(e){try{const t=await fetch("https://registry.npmjs.org/".concat(e));if(!t.ok)return"";const n=await t.json();return n&&n["dist-tags"]&&n["dist-tags"].latest?n["dist-tags"].latest:""}catch(t){return""}}var c=n(0);var l=e=>{let{onFileDrop:t}=e;const[n,o]=Object(r.useState)(!1),[a,s]=Object(r.useState)(""),l=e=>(e.preventDefault(),e.stopPropagation(),!1);return Object(c.jsxs)("div",{children:[Object(c.jsx)("div",{onDragEnter:e=>{l(e),o(!0)},onDragOver:e=>{l(e),o(!0)},onDragLeave:e=>{l(e),o(!1)},onDrop:async e=>{l(e),o(!1);const n=e.dataTransfer.files;if(n.length>0){let e=null,o=null,a="",c="";for(let t=0;t<n.length;t++){const s=n[t];let i="";try{i=await s.text()}catch(r){console.error("Error reading file ".concat(s.name,":"),r);continue}try{const t=JSON.parse(i);t.vulnerabilities||t.advisories?(e=t,a=s.name):t.dependencies&&(o=t,c=s.name)}catch(r){console.error("Error parsing JSON in file ".concat(s.name,":"),r)}}if(console.log("Detected files:",{auditFileName:a,lsFileName:c}),console.log("auditJson:",e),console.log("lsJson:",o),e&&o){s("");try{const n=await async function(e,t){const n=Array.from(function(e){const t=new Set;e.advisories&&"object"===typeof e.advisories&&Object.values(e.advisories).forEach(e=>{e.module_name&&t.add(e.module_name)});e.vulnerabilities&&"object"===typeof e.vulnerabilities&&Object.keys(e.vulnerabilities).forEach(e=>t.add(e));Array.isArray(e)&&e.length>0&&e.forEach(e=>{e.module_name&&t.add(e.module_name),e.package&&t.add(e.package)});return t}(e));if(console.log("Vulnerable packages extracted:",n),0===n.length)return console.warn("No vulnerable packages found in auditJson."),[];const r=new Set(n),o=function(e){const t={};e.advisories&&"object"===typeof e.advisories&&Object.values(e.advisories).forEach(e=>{e.module_name&&(t[e.module_name]={severity:e.severity||"",url:e.url||(e.cves&&e.cves.length?e.cves[0]:"")})});e.vulnerabilities&&"object"===typeof e.vulnerabilities&&Object.entries(e.vulnerabilities).forEach(e=>{let[n,r]=e,o="";if(r.via&&Array.isArray(r.via)&&r.via.length>0){const e=r.via.find(e=>"object"===typeof e&&e.url);e&&(o=e.url)}t[n]={severity:r.severity||"",url:o}});return t}(e),a=function(e,t,n){const r=[],o=new Set;function a(e,s){if(e&&e.dependencies)for(const[i,c]of Object.entries(e.dependencies)){if(!t.has(i)){a(c,[...s,i]);continue}const e=[...s,i],l=e.slice(1).join(" -> "),d="".concat(i,"@").concat(c.version||"");if(!o.has(d)){o.add(d);const e=n[i]||{};r.push({package:i,version:c.version||"",parentChain:l,severity:e.severity||"",url:e.url||""})}a(c,e)}}return a(e,[e.name||"root"]),r}(t,r,o);console.log("Parent chains found:",a);const s=new Set,c=[];for(const i of a){const e="".concat(i.package,"@").concat(i.version);s.has(e)||(s.add(e),c.push(i))}for(const l of c)l.latestVersion=await i(l.package);return c}(e,o);console.log("Extracted vulnerable table data:",n),0===n.length?s("No vulnerable packages found in the provided files."):s(""),t(n)}catch(r){console.error("Error processing vulnerability data:",r),s("Error processing vulnerability data. See console for details."),t([])}}else{let n="";e||o?e?o||(n="Missing npm-ls.json. Detected: ".concat(a||"none")):n="Missing npm-audit.json. Detected: ".concat(c||"none"):n="Neither npm-audit.json nor npm-ls.json detected. Please drop both files.",s(n),t([])}}},style:{border:n?"2px dashed #000":"2px solid #ccc",padding:"20px",textAlign:"center",transition:"border 0.3s"},children:n?"Release to drop the files":"Drag and drop your npm-audit.json and npm-ls.json files here"}),a&&Object(c.jsx)("div",{style:{color:"red",marginTop:10},children:a})]})};const d=["package","version","latestVersion","parentChain","severity","url"],u={package:"Vulnerable Package",version:"Current Version",latestVersion:"Latest Version",parentChain:"Parent Chain",severity:"Severity",url:"Advisory URL"};var p=e=>{let{data:t}=e;if(!t||0===t.length)return Object(c.jsx)("div",{style:{marginTop:20,color:"#888"},children:"No data available"});const n=d.filter(e=>t.some(t=>void 0!==t[e]));return Object(c.jsx)("div",{style:{overflowX:"auto",marginTop:20},children:Object(c.jsxs)("table",{style:{borderCollapse:"collapse",width:"100%",background:"#fff",borderRadius:8,boxShadow:"0 2px 8px #0001"},children:[Object(c.jsx)("thead",{children:Object(c.jsx)("tr",{style:{background:"#222",color:"#fff"},children:n.map(e=>Object(c.jsx)("th",{style:{padding:"8px 12px",border:"1px solid #ddd"},children:u[e]||e},e))})}),Object(c.jsx)("tbody",{children:t.map((e,t)=>Object(c.jsx)("tr",{style:{background:t%2===0?"#f9f9f9":"#fff"},children:n.map(t=>Object(c.jsx)("td",{style:{padding:"8px 12px",border:"1px solid #eee",wordBreak:"break-all"},children:"url"===t&&e[t]?Object(c.jsx)("a",{href:e[t],target:"_blank",rel:"noopener noreferrer",children:"Advisory"}):e[t]},t))},t))})]})})};var b=e=>{let{data:t}=e;return Object(c.jsx)("button",{className:"button",onClick:()=>{if(!t||0===t.length)return;const e=Object.keys(t[0]),n=[e.join(",")];for(const i of t)n.push(e.map(e=>{var t;return'"'.concat(String(null!==(t=i[e])&&void 0!==t?t:"").replace(/"/g,'""'),'"')}).join(","));const r=n.join("\n"),o=new Blob([r],{type:"text/csv;charset=utf-8;"}),a=URL.createObjectURL(o),s=document.createElement("a");s.setAttribute("href",a),s.setAttribute("download","audit_report.csv"),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s)},children:"Export as CSV"})};n(3);var v=e=>{let{toggleTheme:t}=e;return Object(c.jsx)("div",{className:"theme-toggle",children:Object(c.jsxs)("label",{children:[Object(c.jsx)("input",{type:"checkbox",onChange:t}),"Toggle Theme"]})})};var j=()=>{const[e,t]=Object(r.useState)([]),[n,o]=Object(r.useState)(!1);return Object(r.useEffect)(()=>{const e=e=>{e.preventDefault(),e.stopPropagation()};return window.addEventListener("dragover",e),window.addEventListener("drop",e),()=>{window.removeEventListener("dragover",e),window.removeEventListener("drop",e)}},[]),Object(c.jsx)("div",{className:n?"black-theme":"white-theme",children:Object(c.jsxs)("div",{className:"container",children:[Object(c.jsx)(v,{toggleTheme:()=>{o(!n)}}),Object(c.jsx)(l,{onFileDrop:e=>{t(e)}}),Object(c.jsx)(p,{data:e}),Object(c.jsx)(b,{data:e})]})})};s.a.render(Object(c.jsx)(o.a.StrictMode,{children:Object(c.jsx)(j,{})}),document.getElementById("root"))},3:function(e,t,n){}},[[10,1,2]]]);
//# sourceMappingURL=main.55d7468e.chunk.js.map