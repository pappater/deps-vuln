{"version":3,"sources":["utils/npmApi.ts","components/DragAndDrop.tsx","components/TableDisplay.tsx","components/ExportButton.tsx","components/ThemeToggle.tsx","App.tsx","index.tsx"],"names":["async","fetchLatestVersion","pkg","res","fetch","concat","ok","data","json","latest","_unused","DragAndDrop","_ref","onFileDrop","dragging","setDragging","useState","status","setStatus","preventDefault","e","stopPropagation","_jsxs","children","_jsx","onDragEnter","onDragOver","onDragLeave","onDrop","files","dataTransfer","length","auditJson","lsJson","auditFileName","lsFileName","i","file","text","err","console","error","name","JSON","parse","vulnerabilities","advisories","dependencies","log","tableData","vulnerable","Array","from","names","Set","Object","values","forEach","a","module_name","add","keys","k","isArray","it","package","extractVulnerablePackages","warn","vulnSet","vulnDetailsMap","map","severity","url","cves","entries","_ref2","v","via","first","find","x","buildVulnDetailsMap","results","tree","vulnerableSet","seen","recurse","node","path","depName","depInfo","has","newPath","parentChain","slice","join","key","version","details","push","findParentChains","uniqKey","uniqResults","r","row","latestVersion","processVulnData","msg","style","border","padding","textAlign","transition","color","marginTop","columnOrder","columnLabels","TableDisplay","headers","filter","col","some","undefined","overflowX","borderCollapse","width","background","borderRadius","boxShadow","header","rowIndex","wordBreak","href","target","rel","ExportButton","className","onClick","handleExport","csvRows","h","_row$h","String","replace","csvContent","blob","Blob","type","URL","createObjectURL","link","document","createElement","setAttribute","visibility","body","appendChild","click","removeChild","ThemeToggle","toggleTheme","onChange","App","setData","isDarkTheme","setIsDarkTheme","useEffect","prevent","window","addEventListener","removeEventListener","newData","ReactDOM","render","React","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.55d7468e.chunk.js","sourcesContent":["// Utility to fetch latest version from npm registry\nexport async function fetchLatestVersion(pkg: string): Promise<string> {\n  try {\n    const res = await fetch(`https://registry.npmjs.org/${pkg}`);\n    if (!res.ok) return '';\n    const data = await res.json();\n    if (data && data['dist-tags'] && data['dist-tags'].latest) {\n      return data['dist-tags'].latest;\n    }\n    return '';\n  } catch {\n    return '';\n  }\n}\n","import React, { useState } from 'react';\nimport { fetchLatestVersion } from '../utils/npmApi';\n\nconst DragAndDrop: React.FC<{ onFileDrop: (data: any) => void }> = ({ onFileDrop }) => {\n    const [dragging, setDragging] = useState(false);\n    const [status, setStatus] = useState<string>(\"\");\n\n        // Prevent default browser behavior for drag/drop events everywhere on the drop zone\n        const preventDefault = (e: React.DragEvent<HTMLDivElement>) => {\n            e.preventDefault();\n            e.stopPropagation();\n            return false;\n        };\n\n        const handleDragEnter = (e: React.DragEvent<HTMLDivElement>) => {\n            preventDefault(e);\n            setDragging(true);\n        };\n\n        const handleDragOver = (e: React.DragEvent<HTMLDivElement>) => {\n            preventDefault(e);\n            setDragging(true);\n        };\n\n        const handleDragLeave = (e: React.DragEvent<HTMLDivElement>) => {\n            preventDefault(e);\n            setDragging(false);\n        };\n\n        const handleDrop = async (e: React.DragEvent<HTMLDivElement>) => {\n            preventDefault(e);\n            setDragging(false);\n\n            const files = e.dataTransfer.files;\n            if (files.length > 0) {\n                let auditJson: any = null;\n                let lsJson: any = null;\n                let auditFileName = \"\";\n                let lsFileName = \"\";\n                for (let i = 0; i < files.length; i++) {\n                    const file = files[i];\n                    let text = '';\n                    try {\n                        text = await file.text();\n                    } catch (err) {\n                        console.error(`Error reading file ${file.name}:`, err);\n                        continue;\n                    }\n                    try {\n                        const json = JSON.parse(text);\n                        if (json.vulnerabilities || json.advisories) {\n                            auditJson = json;\n                            auditFileName = file.name;\n                        } else if (json.dependencies) {\n                            lsJson = json;\n                            lsFileName = file.name;\n                        }\n                    } catch (err) {\n                        console.error(`Error parsing JSON in file ${file.name}:`, err);\n                    }\n                }\n                // Debug logging\n                console.log(\"Detected files:\", { auditFileName, lsFileName });\n                console.log(\"auditJson:\", auditJson);\n                console.log(\"lsJson:\", lsJson);\n                if (auditJson && lsJson) {\n                    setStatus(\"\");\n                    try {\n                        const tableData = await processVulnData(auditJson, lsJson);\n                        console.log(\"Extracted vulnerable table data:\", tableData);\n                        if (tableData.length === 0) {\n                            setStatus(\"No vulnerable packages found in the provided files.\");\n                        } else {\n                            setStatus(\"\");\n                        }\n                        onFileDrop(tableData);\n                    } catch (err) {\n                        console.error(\"Error processing vulnerability data:\", err);\n                        setStatus(\"Error processing vulnerability data. See console for details.\");\n                        onFileDrop([]);\n                    }\n                } else {\n                    let msg = \"\";\n                    if (!auditJson && !lsJson) {\n                        msg = \"Neither npm-audit.json nor npm-ls.json detected. Please drop both files.\";\n                    } else if (!auditJson) {\n                        msg = `Missing npm-audit.json. Detected: ${lsFileName || \"none\"}`;\n                    } else if (!lsJson) {\n                        msg = `Missing npm-ls.json. Detected: ${auditFileName || \"none\"}`;\n                    }\n                    setStatus(msg);\n                    onFileDrop([]);\n                }\n            }\n        };\n\n    // Extract vulnerable packages from audit JSON\n    function extractVulnerablePackages(auditJson: any): Set<string> {\n        const names = new Set<string>();\n        if (auditJson.advisories && typeof auditJson.advisories === 'object') {\n            Object.values<any>(auditJson.advisories).forEach((a) => {\n                if (a.module_name) names.add(a.module_name);\n            });\n        }\n        if (auditJson.vulnerabilities && typeof auditJson.vulnerabilities === 'object') {\n            Object.keys(auditJson.vulnerabilities).forEach((k) => names.add(k));\n        }\n        if (Array.isArray(auditJson) && auditJson.length > 0) {\n            auditJson.forEach((it) => {\n                if (it.module_name) names.add(it.module_name);\n                if (it.package) names.add(it.package);\n            });\n        }\n        return names;\n    }\n\n    // Build map of vuln details\n    function buildVulnDetailsMap(auditJson: any) {\n        const map: Record<string, { severity: string; url: string }> = {};\n        if (auditJson.advisories && typeof auditJson.advisories === 'object') {\n            Object.values<any>(auditJson.advisories).forEach((a) => {\n                if (a.module_name) {\n                    map[a.module_name] = {\n                        severity: a.severity || '',\n                        url: a.url || (a.cves && a.cves.length ? a.cves[0] : ''),\n                    };\n                }\n            });\n        }\n        if (auditJson.vulnerabilities && typeof auditJson.vulnerabilities === 'object') {\n            Object.entries<any>(auditJson.vulnerabilities).forEach(([pkg, v]) => {\n                let url = '';\n                if (v.via && Array.isArray(v.via) && v.via.length > 0) {\n                    const first = v.via.find((x: any) => typeof x === 'object' && x.url);\n                    if (first) url = first.url;\n                }\n                map[pkg] = {\n                    severity: v.severity || '',\n                    url: url,\n                };\n            });\n        }\n        return map;\n    }\n\n    // Find parent chains for vulnerable packages\n    function findParentChains(tree: any, vulnerableSet: Set<string>, vulnDetailsMap: any) {\n        const results: any[] = [];\n        const seen = new Set();\n        function recurse(node: any, path: string[]) {\n            if (!node || !node.dependencies) return;\n            for (const [depName, depInfo] of Object.entries<any>(node.dependencies)) {\n                if (!vulnerableSet.has(depName)) {\n                    recurse(depInfo, [...path, depName]);\n                    continue;\n                }\n                const newPath = [...path, depName];\n                const parentChain = newPath.slice(1).join(' -> ');\n                const key = `${depName}@${depInfo.version || ''}`;\n                if (!seen.has(key)) {\n                    seen.add(key);\n                    const details = vulnDetailsMap[depName] || {};\n                    results.push({\n                        package: depName,\n                        version: depInfo.version || '',\n                        parentChain: parentChain,\n                        severity: details.severity || '',\n                        url: details.url || '',\n                    });\n                }\n                // Still recurse to find other vulnerable packages deeper in the tree\n                recurse(depInfo, newPath);\n            }\n        }\n        recurse(tree, [tree.name || 'root']);\n        return results;\n    }\n\n    // Main processing function\n    async function processVulnData(auditJson: any, lsJson: any) {\n        const vulnerable = Array.from(extractVulnerablePackages(auditJson));\n        console.log('Vulnerable packages extracted:', vulnerable);\n        if (vulnerable.length === 0) {\n            console.warn('No vulnerable packages found in auditJson.');\n            return [];\n        }\n        const vulnSet = new Set(vulnerable);\n        const vulnDetailsMap = buildVulnDetailsMap(auditJson);\n        const results = findParentChains(lsJson, vulnSet, vulnDetailsMap);\n        console.log('Parent chains found:', results);\n        // Remove duplicates: only one row per unique package@version\n        const uniqKey = new Set();\n        const uniqResults: any[] = [];\n        for (const r of results) {\n            const key = `${r.package}@${r.version}`;\n            if (!uniqKey.has(key)) {\n                uniqKey.add(key);\n                uniqResults.push(r);\n            }\n        }\n        // Fetch latest version for each vulnerable package\n        for (const row of uniqResults) {\n            row.latestVersion = await fetchLatestVersion(row.package);\n        }\n        return uniqResults;\n    }\n\n    return (\n        <div>\n            <div\n                onDragEnter={handleDragEnter}\n                onDragOver={handleDragOver}\n                onDragLeave={handleDragLeave}\n                onDrop={handleDrop}\n                style={{\n                    border: dragging ? '2px dashed #000' : '2px solid #ccc',\n                    padding: '20px',\n                    textAlign: 'center',\n                    transition: 'border 0.3s',\n                }}\n            >\n                {dragging ? 'Release to drop the files' : 'Drag and drop your npm-audit.json and npm-ls.json files here'}\n            </div>\n            {status && <div style={{ color: 'red', marginTop: 10 }}>{status}</div>}\n        </div>\n    );\n};\n\nexport default DragAndDrop;\n","import React from 'react';\n\ninterface TableDisplayProps {\n    data: Array<Record<string, any>>;\n}\n\nconst columnOrder = [\n    'package',\n    'version',\n    'latestVersion',\n    'parentChain',\n    'severity',\n    'url',\n];\n\nconst columnLabels: Record<string, string> = {\n    package: 'Vulnerable Package',\n    version: 'Current Version',\n    latestVersion: 'Latest Version',\n    parentChain: 'Parent Chain',\n    severity: 'Severity',\n    url: 'Advisory URL',\n};\n\nconst TableDisplay: React.FC<TableDisplayProps> = ({ data }) => {\n    if (!data || data.length === 0) {\n        return <div style={{marginTop: 20, color: '#888'}}>No data available</div>;\n    }\n\n    // Only show columns that exist in the data\n    const headers = columnOrder.filter(col => data.some(row => row[col] !== undefined));\n\n    return (\n        <div style={{overflowX: 'auto', marginTop: 20}}>\n            <table style={{borderCollapse: 'collapse', width: '100%', background: '#fff', borderRadius: 8, boxShadow: '0 2px 8px #0001'}}>\n                <thead>\n                    <tr style={{background: '#222', color: '#fff'}}>\n                        {headers.map((header) => (\n                            <th key={header} style={{padding: '8px 12px', border: '1px solid #ddd'}}>{columnLabels[header] || header}</th>\n                        ))}\n                    </tr>\n                </thead>\n                <tbody>\n                    {data.map((row, rowIndex) => (\n                        <tr key={rowIndex} style={{background: rowIndex % 2 === 0 ? '#f9f9f9' : '#fff'}}>\n                            {headers.map((header) => (\n                                <td key={header} style={{padding: '8px 12px', border: '1px solid #eee', wordBreak: 'break-all'}}>\n                                    {header === 'url' && row[header] ? (\n                                        <a href={row[header]} target=\"_blank\" rel=\"noopener noreferrer\">Advisory</a>\n                                    ) : row[header]}\n                                </td>\n                            ))}\n                        </tr>\n                    ))}\n                </tbody>\n            </table>\n        </div>\n    );\n}\n\nexport default TableDisplay;\n","import React from 'react';\n\ninterface ExportButtonProps {\n    data: any[];\n}\n\nconst ExportButton: React.FC<ExportButtonProps> = ({ data }) => {\n    const handleExport = () => {\n        if (!data || data.length === 0) return;\n        const headers = Object.keys(data[0]);\n        const csvRows = [headers.join(\",\")];\n        for (const row of data) {\n            csvRows.push(headers.map(h => `\"${String(row[h] ?? '').replace(/\"/g, '\"\"')}\"`).join(\",\"));\n        }\n        const csvContent = csvRows.join(\"\\n\");\n        const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\n        const url = URL.createObjectURL(blob);\n        const link = document.createElement(\"a\");\n        link.setAttribute(\"href\", url);\n        link.setAttribute(\"download\", \"audit_report.csv\");\n        link.style.visibility = 'hidden';\n        document.body.appendChild(link);\n        link.click();\n        document.body.removeChild(link);\n    };\n\n    return (\n        <button className=\"button\" onClick={handleExport}>\n            Export as CSV\n        </button>\n    );\n};\n\nexport default ExportButton;","\nimport React from 'react';\nimport '../styles/theme.css';\n\ninterface ThemeToggleProps {\n    toggleTheme: () => void;\n}\n\nconst ThemeToggle: React.FC<ThemeToggleProps> = ({ toggleTheme }) => {\n    return (\n        <div className=\"theme-toggle\">\n            <label>\n                <input type=\"checkbox\" onChange={toggleTheme} />\n                Toggle Theme\n            </label>\n        </div>\n    );\n};\n\nexport default ThemeToggle;","import React, { useState, useEffect } from 'react';\nimport DragAndDrop from './components/DragAndDrop';\nimport TableDisplay from './components/TableDisplay';\nimport ExportButton from './components/ExportButton';\nimport ThemeToggle from './components/ThemeToggle';\nimport './styles/theme.css';\n\nconst App: React.FC = () => {\n    const [data, setData] = useState<any[]>([]);\n    const [isDarkTheme, setIsDarkTheme] = useState<boolean>(false);\n\n    const handleDataChange = (newData: any[]) => {\n        setData(newData);\n    };\n\n    const toggleTheme = () => {\n        setIsDarkTheme(!isDarkTheme);\n    };\n\n    // Prevent default browser drag/drop for the whole window\n    useEffect(() => {\n        const prevent = (e: DragEvent) => {\n            e.preventDefault();\n            e.stopPropagation();\n        };\n        window.addEventListener('dragover', prevent);\n        window.addEventListener('drop', prevent);\n        return () => {\n            window.removeEventListener('dragover', prevent);\n            window.removeEventListener('drop', prevent);\n        };\n    }, []);\n\n    return (\n        <div className={isDarkTheme ? 'black-theme' : 'white-theme'}>\n            <div className=\"container\">\n                <ThemeToggle toggleTheme={toggleTheme} />\n                <DragAndDrop onFileDrop={handleDataChange} />\n                <TableDisplay data={data} />\n                <ExportButton data={data} />\n            </div>\n        </div>\n    );\n};\n\nexport default App;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport './styles/theme.css';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);"],"sourceRoot":""}